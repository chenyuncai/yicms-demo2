const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CfPP5jbu.js","./CuBocSt8.js","./DbS6LuAR.js"])))=>i.map(i=>d[i]);
import{V as W,W as R,b as k}from"./CuBocSt8.js";import{t as B}from"./DbS6LuAR.js";const C=(t,s)=>{const n=t._conditions;return n.length>0?`(${n.join(` ${s} `)})`:""},w=t=>{const s=[],n={_conditions:s,where(r,i,e){let o;switch(i.toUpperCase()){case"IN":case"NOT IN":if(Array.isArray(e)){const c=e.map(h=>S(h)).join(", ");o=`"${String(r)}" ${i.toUpperCase()} (${c})`}else throw new TypeError(`Value for ${i} must be an array`);break;case"BETWEEN":case"NOT BETWEEN":if(Array.isArray(e)&&e.length===2)o=`"${String(r)}" ${i.toUpperCase()} ${S(e[0])} AND ${S(e[1])}`;else throw new Error(`Value for ${i} must be an array with two elements`);break;case"IS NULL":case"IS NOT NULL":o=`"${String(r)}" ${i.toUpperCase()}`;break;case"LIKE":case"NOT LIKE":o=`"${String(r)}" ${i.toUpperCase()} ${S(e)}`;break;default:o=`"${String(r)}" ${i} ${S(typeof e=="boolean"?Number(e):e)}`}return s.push(`${o}`),n},andWhere(r){const i=r(w());return s.push(C(i,"AND")),n},orWhere(r){const i=r(w());return s.push(C(i,"OR")),n}};return n},D=(t,s)=>{const n={conditions:[],selectedFields:[],offset:0,limit:0,orderBy:[],count:{field:"",distinct:!1}},r={__params:n,andWhere(e){const o=e(w());return n.conditions.push(C(o,"AND")),r},orWhere(e){const o=e(w());return n.conditions.push(C(o,"OR")),r},path(e){return r.where("path","=",W(e))},skip(e){return n.offset=e,r},where(e,o,c){return r.andWhere(h=>h.where(String(e),o,c)),r},limit(e){return n.limit=e,r},select(...e){return e.length&&n.selectedFields.push(...e),r},order(e,o){return n.orderBy.push(`"${String(e)}" ${o}`),r},async all(){return s(t,i()).then(e=>e||[])},async first(){return s(t,i({limit:1})).then(e=>e[0]||null)},async count(e="*",o=!1){return s(t,i({count:{field:String(e),distinct:o}})).then(c=>c[0].count)}};function i(e={}){let o="SELECT ";if(e!=null&&e.count)o+=`COUNT(${e.count.distinct?"DISTINCT ":""}${e.count.field}) as count`;else{const h=Array.from(new Set(n.selectedFields));o+=h.length>0?h.map(p=>`"${String(p)}"`).join(", "):"*"}o+=` FROM ${B[String(t)]}`,n.conditions.length>0&&(o+=` WHERE ${n.conditions.join(" AND ")}`),n.orderBy.length>0?o+=` ORDER BY ${n.orderBy.join(", ")}`:o+=" ORDER BY stem ASC";const c=(e==null?void 0:e.limit)||n.limit;return c>0&&(n.offset>0?o+=` LIMIT ${c} OFFSET ${n.offset}`:o+=` LIMIT ${c}`),o}return r};function S(t){return`'${String(t).replace(/'/g,"''")}'`}const x=/\d/,P=["-","_","/","."];function F(t=""){if(!x.test(t))return t!==t.toLowerCase()}function j(t,s){const n=P,r=[];if(!t||typeof t!="string")return r;let i="",e,o;for(const c of t){const h=n.includes(c);if(h===!0){r.push(i),i="",e=void 0;continue}const p=F(c);if(o===!1){if(e===!1&&p===!0){r.push(i),i=c,e=p;continue}if(e===!0&&p===!1&&i.length>1){const a=i.at(-1);r.push(i.slice(0,Math.max(0,i.length-1))),i=a+c,e=p;continue}}i+=c,e=p,o=h}return r.push(i),r}function q(t){return t?t[0].toUpperCase()+t.slice(1):""}function M(t,s){return t?(Array.isArray(t)?t:j(t)).map(n=>q(s!=null&&s.normalize?n.toLowerCase():n)).join(""):""}function X(t,s){return t?(Array.isArray(t)?t:j(t)).map(n=>n.toLowerCase()).join("-"):""}function L(t){return s=>(s=s||{},(t||[]).filter(n=>typeof s[n]<"u").reduce((n,r)=>Object.assign(n,{[r]:s[r]}),{}))}async function Q(t,s=[]){var p;const n=t.__params;(p=n==null?void 0:n.orderBy)!=null&&p.length||(t=t.order("stem","ASC"));const r=await t.orWhere(a=>a.where("navigation","<>","false").where("navigation","IS NULL")).select("navigation","stem","path","title","meta",...s||[]).all(),{contents:i,configs:e}=r.reduce((a,u)=>{var d;if(String(u.stem).split("/").pop()===".navigation"){u.title=((d=u.title)==null?void 0:d.toLowerCase())==="navigation"?"":u.title;const y=u.path.split("/").slice(0,-1).join("/")||"/";a.configs[y]={...u,...u.body}}else a.contents.push(u);return a},{configs:{},contents:[]}),o=a=>({...L(["title",...s])(a),...a.meta,..._(a==null?void 0:a.navigation)?a.navigation:{}}),c=a=>({...L(["title",...s])(a),..._(a==null?void 0:a.navigation)?a.navigation:{}}),h=i.reduce((a,u)=>{var I;const d=u.path.substring(1).split("/"),y=u.stem.split("/"),T=!!((I=y[y.length-1])!=null&&I.match(/([1-9]\d*\.)?index/g)),v=l=>({title:l.title,path:l.path,stem:l.stem,children:[],...c(l)}),f=v(u);if(T){const l=e[f.path];if(typeof(l==null?void 0:l.navigation)<"u"&&(l==null?void 0:l.navigation)===!1)return a;if(u.path!=="/"){const g=v(u);f.children.push(g)}l&&Object.assign(f,o(l))}if(d.length===1){const l=a.find(g=>g.path===f.path&&g.page===!1);return T&&l?Object.assign(l,{page:void 0,children:[...f.children||[],...l.children||[]]}):a.push(f),a}const A=d.slice(0,-1).reduce((l,g,O)=>{const E="/"+d.slice(0,O+1).join("/"),m=e[E];if(typeof(m==null?void 0:m.navigation)<"u"&&m.navigation===!1)return[];let $=l.find(b=>b.path===E);if(!$){const b=m?o(m):{};$={...b,title:b.title||V(g),path:E,stem:y.slice(0,O+1).join("/"),children:[],page:!1},l.push($)}return $.children},a),N=A.find(l=>l.path===f.path&&l.page===!1);return N?Object.assign(N,{...f,page:void 0,children:[...f.children||[],...N.children||[]]}):A.push(f),a},[]);return U(h)}function U(t){var n;const s=t;for(const r of s)(n=r.children)!=null&&n.length?U(r.children):delete r.children;return t}function _(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}const V=t=>t.split(/[\s-]/g).map(M).join(" "),G=t=>{var n,r;const s=(r=(n=R())==null?void 0:n.ssrContext)==null?void 0:r.event;return D(t,(i,e)=>H(s,i,e))};function Z(t,s){return Y(t,n=>Q(n,s))}async function H(t,s,n){return K(s,n)}async function K(t,s){return await k(()=>import("./CfPP5jbu.js"),__vite__mapDeps([0,1,2]),import.meta.url).then(r=>r.loadDatabaseAdapter(t)).then(r=>r.all(s))}function Y(t,s){const n=G(t),r={where(i,e,o){return n.where(String(i),e,o),r},andWhere(i){return n.andWhere(i),r},orWhere(i){return n.orWhere(i),r},order(i,e){return n.order(String(i),e),r},then(i,e){return s(n).then(i,e)},catch(i){return this.then(void 0,i)},finally(i){return this.then(void 0,void 0).finally(i)},get[Symbol.toStringTag](){return"Promise"}};return r}export{G as a,X as k,M as p,Z as q};
